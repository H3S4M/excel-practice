# Excel Cheat Sheet

## Problems Discussed and Solutions

1. Converting Partial Manufacture Date to Full Year  
   - Problem: Extracted two-digit year (e.g., “85” or “08”) but needed a four-digit year with 19/20 prefix.  
   - Basic Solution:  
     ```excel
     =IF(VALUE(MID(A1,3,2))>30, "19"&MID(A1,3,2), "20"&MID(A1,3,2))
     ```  
   - Anomaly Check:  
     ```excel
     =IF(
       ISNUMBER(VALUE(MID(A1,3,2))),
       IF(VALUE(MID(A1,3,2))>30, "19"&MID(A1,3,2), "20"&MID(A1,3,2)),
       "Invalid Year"
     )
     ```  

2. Understanding the `&` Operator  
   - Purpose: Concatenates (joins) text strings.  
   - Example: `"19" & "85"` yields `"1985"`.  

3. Extracting Today's Year Correctly  
   - Issue: `=YEAR(TODAY())` returned a serialized date (e.g., 1905-07-17) due to cell formatting.  
   - Fixes:  
     - Ensure the cell is formatted as General or Number.  
     - Or force text output:  
       ```excel
       =TEXT(TODAY(),"yyyy")
       ```  

4. Summing Numeric Values Extracted from Text  
   - Problem: Values like “2.50” extracted with `TEXTAFTER` stayed as text, so `SUM()` returned zero or a count.  
   - Core Fix:  
     ```excel
     =VALUE(TRIM(TEXTAFTER(K5,"$",1)))
     ```  
   - Removing Hidden Characters (non-breaking spaces):  
     ```excel
     =VALUE(
       SUBSTITUTE(
         TRIM(TEXTAFTER(K5,"$",1)),
         CHAR(160),
         ""
       )
     )
     ```  

5. TYPE vs. ISNUMBER Contradiction  
   - Observation: `TYPE(cell)=2` but `ISNUMBER(cell)=FALSE`.  
   - Cause: Hidden or special characters making the value unusable in math.  
   - Diagnostic:  
     ```excel
     =CODE(MID(TEXTAFTER(K5,"$",1),1,1))
     ```  
   - Cleanup: See non-breaking space removal above.

---

## Formulas Reference

- LEFT(text, n)  
- RIGHT(text, n)  
- MID(text, start, length)  
- TEXTBEFORE(text, delimiter, [instance])  
- TEXTAFTER(text, delimiter, [instance])  
- VALUE(text)  
- IF(condition, value_if_true, value_if_false)  
- ISNUMBER(value)  
- YEAR(serial_date)  
- TODAY()  
- CONCATENATE(text1, text2, …)  
- `&` (text1 & text2)  
- UPPER(text)  
- SUM(range)  
- SUMIF(range, criteria, [sum_range])  
- MAX(range)  
- MIN(range)  
- AVERAGE(range)  
- OR(condition1, condition2, …)  
- MOD(number, divisor)  
- ROUNDUP(number, num_digits)  

---

## Key Concepts Explained

- Structured References (`[@[Car ID]]`)  
  Refers to the value in the “Car ID” column of the same table row. Keeps formulas dynamic when rows are added or sorted.

- Absolute vs. Relative References  
  - Relative (A1): shifts when copied.  
  - Absolute ($A$1): locks both row and column.  
  - Mixed ($A1 or A$1): locks only one axis.

- Embedding and Combining Functions  
  Wrapping `YEAR(TODAY())` inside other formulas requires ensuring each function outputs the correct data type (use `TEXT()` or cell formatting as needed).

- Using VALUE() to Convert Text to Number  
  Essential when importing data or extracting numbers from strings so mathematical functions work.

- Charts  
  - Bar Charts: compare categories side by side.  
  - Scatter Plots: show relationships/trends between two variables.  
  - Pie Charts: visualize part-to-whole proportions.

- Pivot Tables  
  Summarize large datasets, group by categories, calculate subtotals and averages without manual formulas.

- Filters  
  Apply in-cell dropdowns to display only rows matching criteria, then operate on a subset of data.

- Conditional Formatting  
  Highlight cells based on rules (e.g., values above average, duplicate entries, top 10%, color scales).

---

## Real-World Excel Use Cases

- Inventory Management: track stock levels, reorder points, restocking dates, and supplier costs.  
- Sales Analysis: calculate monthly totals, year-over-year growth, and top-selling products using SUMIF, pivot tables, and charts.  
- Financial Dashboards: combine KPI metrics (profit, margin, cash flow) with conditional formatting for quick status checks.  
- Manufacturing Logs: parse serial numbers for manufacture dates, validate entries, and flag anomalies.  
- Budget Forecasting: project expenses and revenues with historical averages, `ROUNDUP` for cost estimates, and scenario comparisons.  
- Quality Control Analytics: analyze defect rates by batch using pivot tables and scatter plots to identify trends.  
- Resource Allocation: use tables and filters to assign team members to projects, track hours, and calculate utilization rates.

---